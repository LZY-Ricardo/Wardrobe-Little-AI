# 智能穿搭项目扩展建议

## 背景
- 前端：场景推荐/生成结果多处静态，缺少全局登录守卫与错误态，上传/请求缺超时重试，存在编码与 icon 问题。
- 后端：无模型层和表结构说明，缺统一错误/日志/限流；图片 base64 入库；AI 工具链为 MVP，缺降级与更丰富的写操作。
- 外部依赖：Coze 工作流、Ollama、对象存储/MySQL 需可用；未配置时无兜底。

## 优先级与里程碑
- 短期（1~2 周）：补齐用户可感知缺口与稳定性。
- 中期（2~4 周）：完善数据与基础设施，提升可靠性和可观测性。
- 长期（4+ 周）：强化个性化与智能化，做运营向增长能力。

## 短期扩展与修复
- 场景推荐渲染：把 /scene/generateSceneSuits 响应展示到推荐卡片，补加载/错误态与重试。
- 路由守卫与状态：基于 access/refresh token 做路由拦截与续签失败跳转；落地 src/store（用户、配置、加载态）。
- 请求健壮性：axios 超时与幂等请求重试，上传大小/类型校验，失败重传；文件压缩失败友好提示。
- UI 细节：修复 UTF-8 乱码与 iconfont class 组合；为生成/上传流程提供占位与进度反馈。

## 中期扩展（结合 Vercel 前端 + Zeabur 后端/DB 部署）
- 资产存储：改用对象存储+CDN（优先选与 Zeabur 同区域的 OSS/S3 兼容服务），库中仅存元数据/压缩图；前端懒加载+占位。上传走后端签名/直传，避免 Vercel 前端暴露密钥；CORS 允许 Vercel 域名。
- 数据与模型层：补 models schema（user/clothes/scene/history），引入统一错误处理中间件、结构化日志（请求ID/耗时/外部调用）。Zeabur 日志输出按 stdout/stderr，必要时接入第三方日志/可观测性服务。
- 安全与可靠性：Zeabur 实例数有限时增加限流/输入大小限制；生成接口超时+重试+熔断（避免长时占用），Coze/Ollama 不可用时规则兜底。SSE/长连接（/chat）需提高反向代理超时。
- 业务增强：Top/Bot 查询支持类型映射配置（不再依赖“上衣/下衣”命名），支持衣柜批量导入/导出。对批处理类任务（大文件）用后台任务/分片，避免 Zeabur 单实例阻塞。

## 长期扩展
- 个性化画像：基于点赞/使用记录构建偏好（色系/版型/场景）并用于排序与生成提示增强。
- 多模态洞察：自动提取色卡、材质、场景标签，提供“衣柜洞察”页（占比、缺口、搭配建议）。
- AI 工具链：在 /chat 扩展安全写操作（新增/更新衣物、生成搭配方案/购物清单），保持确认码二次确认；支持多轮规划。
- 运营与留存：穿搭日历/历史回溯、收藏/分享海报、节日/场景推送与 A/B 风格主题。

## 依赖与风险
- 外部服务：Coze PAT 与 workflow*、Ollama 服务与模型、对象存储与 CDN 配置；需超时与降级策略。
- 数据库：需明确建表 SQL 与迁移策略；避免直接拼接 SQL 引发注入。
- 存储成本：图片/视频流量与存储需监控，必要时做压缩与缓存。

## 建议的后续动作
1) 选定短期列表中的 2~3 个高价值项（如场景推荐渲染、路由守卫、请求超时/重试）先落地并冒烟。
2) 并行设计资产存储迁移与模型层/日志方案，明确表结构与迁移步骤。
3) 确认外部依赖可用性（Coze、Ollama、对象存储），为生成/聊天链路补超时与降级。
